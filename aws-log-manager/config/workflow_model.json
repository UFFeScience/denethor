{
    "serviceProvider": {
        "name": "AWS Lambda",
        "memory": "128",
        "timeout": "600",
        "cpu": "1"
    },
    
    "workflow": {
        "name": "aws_lambda_eval",
        "description": "Performance Evaluation of Lambda Functions in AWS",
        
        "dataFiles": {
            "path": "_data/full_dataset",
            "files": ["ORTHOMCL1","ORTHOMCL256"]
        },

        "steps": [
            {
                "name": "Upload files to AWS S3",
                "module": "aws_tasks",
                "handler": "upload_files_to_s3",
                "params": {
                    "bucket": "mribeiro-input-files",
                    "key": ""
                },
            "active": false
            },
            {
                "name": "Trigger lambda execution",
                "module": "aws_tasks",
                "handler": "trigger_lambda_execution",
                "params": {
                    "lambdaFunction": "tree_constructor",
                    "inputBucket": "mribeiro-input-files",
                    "inputKey": "",
                    "outputBucket": "mribeiro-tree-files",
                    "outputKey": "",
                    "execution_strategy": "for_each_file"
                },
                "active": false
            },
            {
                "name": "Wait for lambda execution to complete",
                "module": "aws_tasks",
                "handler": "wait_for_lambda_completion",
                "params": {
                    "lambdaFunction": "tree_constructor"
                },
                "active": false
            },
            {
                "name": "Trigger lambda execution",
                "module": "aws_tasks",
                "handler": "trigger_lambda_execution",
                "params": {
                    "lambdaFunction": "tree_sub_find",
                    "inputBucket": "mribeiro-tree-files",
                    "inputKey": "",
                    "outputBucket": "mribeiro-subtree-files",
                    "outputKey": "",
                    "execution_strategy": "for_all_files"
                },
                "active": true
            },
            {
                "name": "Wait for lambda function to complete",
                "module": "aws_tasks",
                "handler": "wait_for_lambda_completion",
                "params": {
                    "lambdaFunction": "tree_sub_find"
                },
                "active": false
            },
            {
                "name": "Download files from AWS S3",
                "module": "aws_tasks",
                "handler": "download_files_from_aws_s3",
                "params": {
                    "bucket": "mribeiro-subtree-files"
                },
                "active": false
            },
            {
                "name": "Retrieve logs from AWS",
                "module": "aws_log_retriever",
                "handler": "retrieve_logs_from_aws",
                "params": {
                    "lambdaFunction": ["tree_constructor", "tree_sub_find"],
                    "logFile": "config/logs/logs_{lamda_function}_{execution_id}.json"
                },
                "active": false
            },
            {
                "name": "Store execution info in database",
                "module": "aws_log_analyzer",
                "handler": "store_execution_info_in_database",
                "params": {
                    "lambdaFunction": ["tree_constructor", "tree_sub_find"],
                    "logFile": "config/executions/logs/logs_{lamda_function}_{execution_id}.json"
                },
                "active": false
            }
        ]
    }
}